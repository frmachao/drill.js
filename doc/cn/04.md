# drill.js 进阶

## 初始配置

### 设置baseUrl

之前的案例，我们引用文件的根目录是当前html目录；

如下：

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>01-5</title>
    <script src="js/drill.js"></script>
</head>

<body>
    <script>
    (async ()=>{
        let d1 = await require('js/d1');

        console.log(d1.val);
    })();
    </script>
</body>

</html>
```

其实我们可以更改 `baseUrl`，如下：

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>01-5</title>
    <script src="js/drill.js"></script>
</head>

<body>
    <script>
    (async ()=>{
        drill.config({
            baseUrl:"js/"
        });

        let d1 = await require('d1');

        console.log(d1.val);
    })();
    </script>
</body>

</html>
```

通过 `config` 方法，我们将根目录变成 `js/`；

通过修改 `baseUrl`，我们还能使用其他服务器下的目录；

假设将 `js` 文件都迁移到CDN服务器（假设CDN服务器是 `http://xxx.com/`），那么可以很快修正目录地址：

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>01-5</title>
    <script src="js/drill.js"></script>
</head>

<body>
    <script>
    (async ()=>{
        drill.config({
            baseUrl:"http://xxx.com/js/"
        });

        let d1 = await require('d1');

        console.log(d1.val);
    })();
    </script>
</body>

</html>
```

注意：配置 `baseUrl`是目录，所以记得在末尾加上斜杠 `/` 表示目录地址；

### 设置 paths

## 初始化函数定义

要保证 `drill.js` 载入完成后才执行的函数，可以直接设置全局变量 `drill` 定义函数；

如下：

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>01-5</title>
    <script src="js/drill.js"></script>
</head>

<body>
    <script>
    drill = async ()=>{
        let d1 = await require('js/d1');
        console.log(d1.val);
    }
    </script>
</body>

</html>
```

定义的 drill 变量的函数，将会保证 `drill.js` 载入完成后执行；

所以，这时候我们能将 `drill.js` 的引用script标签改成异步的；

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>01-5</title>
    <script src="js/drill.js" async></script>
</head>

<body>
    <script>
    drill = async (drill)=>{
        let d1 = await require('js/d1');
        console.log(d1.val);
    }
    </script>
</body>

</html>
```

注意看我们标签上加了 `async` 属性， `drill.js` 将会异步执行，不会阻塞页面；

`<script src="js/drill.js" async></script>`

而通过 `drill.js` 初始化后得到的全局变量 `drill` 将会作为参数传递过来；