(e=>{"use strict";const t=document;const n=t.head;var r={};var i={};var c={};var a={paths:r,dirpaths:i,baseUrl:"",dataMap:c,tempM:{}};var o=Array.prototype.slice;var s=e=>o.call(e);var u=Object.prototype.toString;var f=e=>u.call(e).toLowerCase().replace(/(\[object )|(])/g,"");var p=(e,t)=>{!(e instanceof Array)&&(e=s(e));e.some((e,n)=>!1===t(e,n));return e};var l=e=>{let t=e.match(/(.+\/).+/);return t&&t[1]};var d=e=>{let t=e.split(/\//g);let n=[];p(t,e=>{if(".."==e&&n.length&&".."!=n.slice(-1)[0])return void n.pop();n.push(e)});return n.join("/")};var h=(()=>{let e=!1;let t=[];return n=>{e||(e=!0,setTimeout(()=>{for(let e=0;e<t.length;e++)t[e]();t=[];e=!1},0));t.push(n)}})();var v=e=>{for(let t in e)return 0;return 1};var m=e=>void 0===e;var g=e=>new Promise(e);var b=e=>{var t=e.split(" ").filter(e=>{if(e)return e});return[t[0],t.slice(1)]};var k={loadScript:e=>{let r=e.path;let i=t.createElement("script");let{k:k,v:v}=q.cacheInfo;r&&k&&v&&(r.search(/\?/)>-1?r+="&"+k+"="+v:r+="?"+k+"="+v);i.type="text/javascript";i.async=!0;r&&(i.src=r);h(()=>{n.appendChild(i)});return i},agent:(e,t)=>g((n,r)=>{let{param:param,path:path}=e;let i=c[path];if(i)switch(i.state){case"loaded":case"pending":i.c.push({res:n,pubData:t});break;case"resolved":h(()=>{i.get?i.get(e=>{n(e)},t):n()});break;case"rejected":h(()=>{r()})}else{c[path]=i={state:"pending",c:[{res:n,rej:r,pubData:t}]};let o=k.loadScript(e);o.onload=(()=>{i.state="loaded";k.setTemp(e);a.tempM={}}),o.onerror=(()=>{for(;0 in i.c;)i.c.shift().rej("load script error => "+path);a.tempM={};i.state="rejected";delete i.c})}}),toProm:(e,t)=>{let n;let r=g((r,i)=>{let c=[];let a=e.length;let o=()=>{a--;a||(n=null,r(1==c.length?c[0]:c))};p(e,(e,r)=>{e=k.getPath(e,t);let a=k.agent(e,t);a.then(e=>{c[r]=e;n&&n(e,r);o()}).catch(e=>{i(e)})})});r.pend=(e=>{n=e;return r});return r},setTemp:e=>{let{path:path}=e;let{tempM:tempM}=a;let t=tempM.d;let{ids:ids}=tempM;ids&&"string"==f(ids)&&(ids=[ids]);let n=c[path];let r=n.type=tempM.type||"file";ids&&p(ids,e=>{c[e]=n});let i=e=>{for(;0 in n.c;)n.c.shift().res(e);n.get=(t=>{t(e)});n.state="resolved";delete n.c};switch(r){case"file":i();break;case"define":if(f(t).search("function")>-1){let e={},n={exports:e},r=t(function(...e){return k.require(e,{rel:path})},e,n,{FILE:path});r instanceof Promise?r.then(e=>{m(e)&&"object"==f(n.exports)&&!v(n.exports)&&(e=n.exports);i(e)}):i(r)}else i(t);break;case"task":if(i=null,!(f(t).search("function")>-1))throw"task module type error";{let e=n.get=((e,n)=>{let r=t(function(...e){return k.require(e,{rel:path})},n.pdata,{FILE:path});r.then(t=>{e(t)})});for(;0 in n.c;){let{res:res,pubData:pubData}=n.c.shift();e(res,pubData)}}n.state="resolved",delete n.c}},getPath:(e,t)=>{let{param:param,path:path}=e;let n=t.rel;if(r[path])path=r[path];else{let e;for(let t in i)if((e=new RegExp("^"+t)).test(path)){path=path.replace(e,i[t]);break}}if(!/^.+?\/\//.test(path)){/\?.+$/.test(path)||/.js$/.test(path)||(path+=".js");let e=path.match(/^\.\/(.+)/);e?path=l(n)+e[1]:-1==param.indexOf("-r")&&(path=a.baseUrl+path),path=d(path)}e.path=path;return e},require:(e,t={})=>{let n=[];p(e,e=>{let[t,r]=b(e);n.push({path:t,param:r})});let r=k.toProm(n,t);r.post=(e=>{t.pdata=e;return r});return r},define:(e,t)=>{a.tempM={type:"define",d:e,ids:t}},task:(e,t)=>{a.tempM={type:"task",d:e,ids:t}}};var y=(...e)=>k.require(e);var j=(e,t)=>{k.define(e,t)};var w=(e,t)=>{k.task(e,t)};var q={config:e=>{a.baseUrl=e.baseUrl||a.baseUrl;for(let t in e.paths)/\/$/.test(t)?i[t]=e.paths[t]:r[t]=e.paths[t]},remove:e=>{let t=k.getPath(e,{});let n=c[t];if(n)return delete c[t],!0},extend:e=>{e(a,k)},require:y,define:j,task:w,cacheInfo:{k:"srcache"}};let x=t.currentScript;x||(x=t.querySelector(["drill-cache"]));if(x){let e=x.getAttribute("drill-cache");e&&(q.cacheInfo.v=e)}e.require||(e.require=y);e.define||(e.define=j);e.task||(e.task=w);if(e.drill){if(!f(e.drill))throw"async drill.js type error";e.drill(q)}e.drill=q;window.baseResources=a})(window);