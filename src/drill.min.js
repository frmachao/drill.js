(e=>{"use strict";const t=document.head;var n={};var r={};var i={};var c={paths:n,dirpaths:r,baseUrl:"",dataMap:i,tempM:{}};var o=Array.prototype.slice;var a=e=>o.call(e);var s=Object.prototype.toString;var u=e=>s.call(e).toLowerCase().replace(/(\[object )|(])/g,"");var f=(e,t)=>{!(e instanceof Array)&&(e=a(e));e.some((e,n)=>!1===t(e,n));return e};var p=e=>{let t=e.match(/(.+\/).+/);return t&&t[1]};var d=e=>{let t=e.split(/\//g);let n=[];f(t,e=>{if(".."==e&&n.length&&".."!=n.slice(-1)[0])return void n.pop();n.push(e)});return n.join("/")};var l=(()=>{let e=!1;let t=[];return n=>{e||(e=!0,setTimeout(()=>{for(let e=0;e<t.length;e++)t[e]();t=[];e=!1},0));t.push(n)}})();var h=e=>{for(let t in e)return 0;return 1};var v=e=>void 0===e;var g=e=>new Promise(e);var m=e=>{var t=e.split(" ");return[t[0],t.slice(1)]};var b=(e,t)=>{var n=t.slice();n.unshift(e);return n.join(" ")};var k={loadScript:e=>{[e]=m(e);let n=document.createElement("script");let{k:k,v:v}=x.cacheInfo;k&&v&&(e.search(/\?/)>-1?e+="&"+k+"="+v:e+="?"+k+"="+v);n.type="text/javascript";n.async=!0;n.src=e;l(()=>{t.appendChild(n)});return n},toProm:(e,t)=>{let n;let r=g((r,i)=>{let c=[];let o=e.length;let a=()=>{o--;o||(n=null,r(1==c.length?c[0]:c))};f(e,(e,r)=>{let o=k.getPath(e,t);let s=k.agent(o,t);s.then(e=>{c[r]=e;n&&n(e,r);a()}).catch(e=>{i(e)})})});r.pend=(e=>{n=e;return r});return r},agent:(e,t)=>g((n,r)=>{let o;[e,o]=m(e);let a=i[e];if(a)switch(a.state){case"loaded":case"pending":a.c.push({res:n,pubData:t});break;case"resolved":l(()=>{a.get?a.get(e=>{n(e)},t):n()});break;case"rejected":l(()=>{r()})}else{i[e]=a={state:"pending",c:[{res:n,rej:r,pubData:t}]},e=b(e,o);let s=k.loadScript(e);s.onload=(()=>{a.state="loaded";k.setTemp(e);c.tempM={}}),s.onerror=(()=>{for(;0 in a.c;)a.c.shift().rej("load script error => "+e);c.tempM={};a.state="rejected";delete a.c})}}),setTemp:e=>{[e]=m(e);let{tempM:tempM}=c;let t=tempM.d;let{ids:ids}=tempM;ids&&"string"==u(ids)&&(ids=[ids]);let n=i[e];let r=n.type=tempM.type||"file";ids&&f(ids,e=>{i[e]=n});let o=e=>{for(;0 in n.c;)n.c.shift().res(e);n.get=(t=>{t(e)});n.state="resolved";delete n.c};switch(r){case"file":o();break;case"define":if(u(t).search("function")>-1){let n={},r={exports:n},i=t.bind({FILE:e})(function(){return k.require(a(arguments),{rel:e})},n,r);i instanceof Promise?i.then(e=>{v(e)&&"object"==u(r.exports)&&!h(r.exports)&&(e=r.exports);o(e)}):o(i)}else o(t);break;case"task":if(o=null,!(u(t).search("function")>-1))throw"task module type error";{let r=n.get=((n,r)=>{let i=t(function(){return k.require(a(arguments),{rel:e})},r.pdata);i.then(e=>{n(e)})});for(;0 in n.c;){let{res:res,pubData:pubData}=n.c.shift();r(res,pubData)}}n.state="resolved",delete n.c}},getPath:(e,t)=>{let i;[e,i]=m(e);let o=t.rel;if(n[e])e=n[e];else{let t;for(let n in r)if((t=new RegExp("^"+n)).test(e)){e=e.replace(t,r[n]);break}}if(!/^.+?\/\//.test(e)){/\?.+$/.test(e)||/.js$/.test(e)||(e+=".js");let t=e.match(/^\.\/(.+)/);t?e=p(o)+t[1]:-1==i.indexOf("-r")&&(e=c.baseUrl+e),e=d(e)}e=b(e,i);return e},require:(e,t={})=>{let n=k.toProm(e,t);n.post=(e=>{t.pdata=e;return n});return n},define:(e,t)=>{c.tempM={type:"define",d:e,ids:t}},task:(e,t)=>{c.tempM={type:"task",d:e,ids:t}}};var j=function(){return k.require(a(arguments))};var y=(e,t)=>{k.define(e,t)};var w=(e,t)=>{k.task(e,t)};var x={config:e=>{c.baseUrl=e.baseUrl||c.baseUrl;for(let t in e.paths)/\/$/.test(t)?r[t]=e.paths[t]:n[t]=e.paths[t]},remove:e=>{let t=k.getPath(e,{});let n=i[t];if(n)return delete i[t],!0},extend:e=>{e(c,k)},require:j,define:y,task:w,cacheInfo:{k:"srcache"}};e.require||(e.require=j);e.define||(e.define=y);e.task||(e.task=w);e.drill=x;window.baseResources=c})(window);