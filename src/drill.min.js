(e=>{"use strict";const t=document.head;var n={};var r={};var i={};var o={paths:n,dirpaths:r,baseUrl:"",dataMap:i,tempM:{}};var c=Array.prototype.slice;var a=e=>c.call(e);var s=Object.prototype.toString;var u=e=>s.call(e).toLowerCase().replace(/(\[object )|(])/g,"");var f=(e,t)=>{!(e instanceof Array)&&(e=a(e));e.some((e,n)=>!1===t(e,n));return e};var l=e=>{let t=e.match(/(.+\/).+/);return t&&t[1]};var p=e=>{let t=e.split(/\//g);let n=[];f(t,e=>{if(".."==e&&n.length&&".."!=n.slice(-1)[0])return void n.pop();n.push(e)});return n.join("/")};var d=(()=>{let e=!1;let t=[];return n=>{e||(e=!0,setTimeout(()=>{for(let e=0;e<t.length;e++)t[e]();t=[];e=!1},0));t.push(n)}})();var h=e=>{for(let t in e)return 0;return 1};var v=e=>void 0===e;var g=e=>new Promise(e);var m=e=>{var t=e.split(" ");return[t[0],t.slice(1)]};var b=(e,t)=>{var n=t.slice();n.unshift(e);return n.join(" ")};var k={loadScript:e=>{[e]=m(e);let n=document.createElement("script");let{k:k,v:v}=x.cacheInfo;k&&v&&(e.search(/\?/)>-1?e+="&"+k+"="+v:e+="?"+k+"="+v);n.type="text/javascript";n.async=!0;n.src=e;d(()=>{t.appendChild(n)});return n},agent:(e,t)=>g((n,r)=>{let c;[e,c]=m(e);let a=i[e];if(a)switch(a.state){case"loaded":case"pending":a.c.push({res:n,pubData:t});break;case"resolved":d(()=>{a.get?a.get(e=>{n(e)},t):n()});break;case"rejected":d(()=>{r()})}else{i[e]=a={state:"pending",c:[{res:n,rej:r,pubData:t}]},e=b(e,c);let s=k.loadScript(e);s.onload=(()=>{a.state="loaded";k.setTemp(e);o.tempM={}}),s.onerror=(()=>{for(;0 in a.c;)a.c.shift().rej("load script error => "+e);o.tempM={};a.state="rejected";delete a.c})}}),toProm:(e,t)=>{let n;let r=g((r,i)=>{let o=[];let c=e.length;let a=()=>{c--;c||(n=null,r(1==o.length?o[0]:o))};f(e,(e,r)=>{let c=k.getPath(e,t);let s=k.agent(c,t);s.then(e=>{o[r]=e;n&&n(e,r);a()}).catch(e=>{i(e)})})});r.pend=(e=>{n=e;return r});return r},setTemp:e=>{[e]=m(e);let{tempM:tempM}=o;let t=tempM.d;let{ids:ids}=tempM;ids&&"string"==u(ids)&&(ids=[ids]);let n=i[e];let r=n.type=tempM.type||"file";ids&&f(ids,e=>{i[e]=n});let c=e=>{for(;0 in n.c;)n.c.shift().res(e);n.get=(t=>{t(e)});n.state="resolved";delete n.c};switch(r){case"file":c();break;case"define":if(u(t).search("function")>-1){let n={},r={exports:n},i=t(function(...t){return k.require(t,{rel:e})},n,r,{FILE:e});i instanceof Promise?i.then(e=>{v(e)&&"object"==u(r.exports)&&!h(r.exports)&&(e=r.exports);c(e)}):c(i)}else c(t);break;case"task":if(c=null,!(u(t).search("function")>-1))throw"task module type error";{let r=n.get=((n,r)=>{let i=t(function(...t){return k.require(t,{rel:e})},r.pdata,{FILE:e});i.then(e=>{n(e)})});for(;0 in n.c;){let{res:res,pubData:pubData}=n.c.shift();r(res,pubData)}}n.state="resolved",delete n.c}},getPath:(e,t)=>{let i;[e,i]=m(e);let c=t.rel;if(n[e])e=n[e];else{let t;for(let n in r)if((t=new RegExp("^"+n)).test(e)){e=e.replace(t,r[n]);break}}if(!/^.+?\/\//.test(e)){/\?.+$/.test(e)||/.js$/.test(e)||(e+=".js");let t=e.match(/^\.\/(.+)/);t?e=l(c)+t[1]:-1==i.indexOf("-r")&&(e=o.baseUrl+e),e=p(e)}e=b(e,i);return e},require:(e,t={})=>{let n=k.toProm(e,t);n.post=(e=>{t.pdata=e;return n});return n},define:(e,t)=>{o.tempM={type:"define",d:e,ids:t}},task:(e,t)=>{o.tempM={type:"task",d:e,ids:t}}};var j=(...e)=>k.require(e);var y=(e,t)=>{k.define(e,t)};var w=(e,t)=>{k.task(e,t)};var x={config:e=>{o.baseUrl=e.baseUrl||o.baseUrl;for(let t in e.paths)/\/$/.test(t)?r[t]=e.paths[t]:n[t]=e.paths[t]},remove:e=>{let t=k.getPath(e,{});let n=i[t];if(n)return delete i[t],!0},extend:e=>{e(o,k)},require:j,define:y,task:w,cacheInfo:{k:"srcache"}};e.require||(e.require=j);e.define||(e.define=y);e.task||(e.task=w);if(e.drill){if(!u(e.drill))throw"async drill.js type error";e.drill(x)}e.drill=x;window.baseResources=o})(window);